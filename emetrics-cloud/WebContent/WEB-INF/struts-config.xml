<?xml version="1.0" encoding="ISO-8859-1" ?>

<!DOCTYPE struts-config PUBLIC
          "-//Apache Software Foundation//DTD Struts Configuration 1.1//EN"
          "http://jakarta.apache.org/struts/dtds/struts-config_1_1.dtd">

<struts-config>

  <form-beans>
    <form-bean name="loginForm" type="org.ei.struts.emetrics.security.LoginForm"/>
    <form-bean name="customersForm" type="org.ei.struts.emetrics.actions.CustomersForm"/>
    <form-bean name="reportForm" type="org.ei.struts.emetrics.actions.ReportForm"/>
    <form-bean name="switchForm" type="org.ei.struts.emetrics.actions.CustomerSwitchForm"/>
  </form-beans>

  <global-forwards>

   	<forward  name="export"       		path="/exportPage.jsp"/>
    <forward  name="login"              path="/security/login.jsp"/>

    <forward  name="print"            	path="/print.do"/>

    <forward  name="menu"               path="/menu.do"/>
    <forward  name="logout"             path="/logout.do"/>
    <forward  name="reports"            path="/reports.do"/>
    <forward  name="customers"          path="/customers.do"/>
    <forward  name="description"		path="/description.do"/>
    <forward  name="support"			path="/support.do"/>
    <forward  name="switch"             path="/switch.do"/>
    <forward  name="switchparent"       path="/switch.do?parentonly=true"/>
    <forward  name="switchback"         path="/switch.do?action=return"/>
  </global-forwards>

  <action-mappings>

    <action    path="/switch"
    		   type="org.ei.struts.emetrics.actions.CustomerSwitchAction"
              scope="request"
    		   name="switchForm"
    	   validate="false">
	    <forward  name="error"				path="errorLayout"/>
    </action>

    <action    path="/allreports"
    		   type="org.ei.struts.emetrics.actions.AllReportAction"
    		   name="reportForm"
              scope="request"
    	   validate="false">
        <forward name="success"               path="/pools.jsp"   redirect="true"/>
    </action>

    <action    path="/reports"
    		   type="org.ei.struts.emetrics.actions.ReportAction"
              scope="request"
    		   name="reportForm"
    	   validate="false">
    	<forward  name="success"       		path="reportLayout"/>
	    <forward  name="descriptions"       path="descriptionLayout"/>
    </action>

    <action    path="/print"
    		   type="org.ei.struts.emetrics.actions.ReportAction"
              scope="request"
    		   name="reportForm"
    	   validate="false">
    	<forward   name="success"       	path="printLayout"/>
    </action>

    <action    path="/customers"
    		   type="org.ei.struts.emetrics.actions.CustomersAction"
               scope="request"
    	       name="customersForm"
    	      input="/customersPage.jsp"
    	   validate="false">
    	<forward   name="success"       	path="customersLayout"/>
    </action>

    <action    path="/main"
               type="org.apache.struts.actions.ForwardAction"
          parameter="/menu.do"/>

    <action    path="/menu"
               type="org.ei.struts.emetrics.actions.MainForwardAction"
          parameter="/mainPage.jsp"/>

    <action    path="/logoff"
               type="org.apache.struts.actions.ForwardAction"
          parameter="/logout.do"/>

    <action    path="/logout"
               type="org.ei.struts.emetrics.security.LogoutAction">
      <forward name="success"               path="/index.jsp" redirect="true"/>
    </action>

      <action  path="/login"
               type="org.ei.struts.emetrics.security.LoginAction"
              scope="request"
               name="loginForm"
           validate="true"
              input="login">
      <forward name="success"               path="/menu.do"   redirect="true"/>
    </action>

    <action    path="/description"
               type="org.ei.struts.emetrics.actions.MainForwardAction"
          parameter="/reports.do?action=describe"/>

    <action    path="/support"
               type="org.ei.struts.emetrics.actions.MainForwardAction"
          parameter="/supportPage.jsp"/>

  </action-mappings>

  <!-- ========== Controller Configuration ================================ -->

  <controller nocache="true"  processorClass="org.ei.struts.framework.SecureRequestProcessor">
    <!-- The "input" parameter on "action" elements is the name of a
         local or global "forward" rather than a module-relative path -->
    <set-property property="inputForward" value="true"/>
  </controller>

  <message-resources parameter="EmetricsMessageResources"/>

  <!-- ========== Plug Ins Configuration ================================== -->

  <plug-in className="org.ei.struts.emetrics.service.EmetricsServiceFactory"/>

  <plug-in className="org.apache.struts.tiles.TilesPlugin" >
    <set-property property="definitions-config" value="/WEB-INF/Definitions.xml" />
    <set-property property="definitions-factory-class"  value="org.ei.struts.emetrics.tiles.channel.ChannelFactorySet" />
    <set-property property="definitions-parser-validate" value="true" />
    <set-property property="definitions-debug" value="2" />
    <set-property property="definitions-parser-details" value="2" />
    <set-property property="moduleAware" value="true" />
  </plug-in>

  <plug-in className="org.ei.struts.emetrics.businessobjects.reports.ReportsPlugIn">
    <set-property property="pathname" value="/WEB-INF/reports.xml" />
    <set-property property="dtdfile" value="/WEB-INF/reports.dtd" />
  </plug-in>

  <!-- ========== Validation Plug In Configuration ================================== -->

  <plug-in className="org.apache.struts.plugins.ModuleConfigVerifier"/>

  <plug-in className="org.apache.struts.validator.ValidatorPlugIn">
    <set-property
        property="pathnames"
        value="/WEB-INF/validator-rules.xml,/WEB-INF/validation.xml"/>
  </plug-in>

</struts-config>