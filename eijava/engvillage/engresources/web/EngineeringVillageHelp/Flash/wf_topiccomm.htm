<!-- saved from url=(0014)about:internet -->
<HTML>
<HEAD>
	<TITLE>Topic Communication</TITLE>
</HEAD>
<BODY>

<script type="text/javascript" language="javascript" src="whver.js"></script>
<script type="text/javascript" language="javascript" src="wf_swfcomm.js"></script>
<script type="text/javascript">

	var gTopicSwfLoadedInterval = null;
	var strFlashVars = "";
	var TOPIC_COMM_TIMEOUT = 1500;
	var gbLoaded = false;

	CreateFSHandler("topicCommSWF");
	cmdTimerID = window.setInterval("CheckCommandQueues()", QUEUE_CHECK_TIMEOUT);
	CreateCommSwf("wf_topiccomm.swf","topicCommSWF", strFlashVars, "500px", "100px", parent.parent.UniqueID())

	function SendParamPasser(strFlashVars)
	{
		parent.parent.SendParamPasser(strFlashVars);
	}

	function ReloadTopicComm()
	{
		window.location.reload();
	}
	function CheckParamPasser()
	{
		parent.parent.CheckParamPasser();
	}
	function DoCommand(cmd, param1, param2) {
		switch (cmd) {
			case "CmdDisplayTopic":
				parent.parent.NavigateToTopic(param1, param2);
				break;
	
			case "CmdScrollbarDragMove":
			case "CmdScrollbarDragStop":
			case "CmdScrollbarDragStart":
			case "CmdPrint":
				parent.parent.SendCmdToTopic(cmd, param1, param2);
				break;

			case "CmdTopicSwfLoaded":
				clearInterval(gTopicSwfLoadedInterval);
				gbLoaded = true;
				if (!gbSWFLoaded)
				{
					SendCmdToSWF("CmdGotTopicSwfLoaded");
					if (parent.parent.SendQueuedCmds)
					{
						parent.parent.SendQueuedCmds()
					}
				}
				break;
			default:
				break;
		}
	}

	if ((gbNav4 && !gbNav6) || gbKonqueror)
	{
		gTopicSwfLoadedInterval = setTimeout("ReloadTopicComm()",TOPIC_COMM_TIMEOUT);
	}
	
</script>


</BODY>
</HTML>

