<?xml version="1.0" encoding="utf-8"?>
<!-- Copyright ©2016 LexisNexis Univentio, The Netherlands. -->
<lexisnexis-patent-document schema-version="1.13" date-produced="20160127" file="US20150257668A1.xml" produced-by="LexisNexis-Univentio" lang="eng" date-inserted="20150917" time-inserted="030200" date-changed="20151128" time-changed="231154">
  <bibliographic-data lang="eng">
    <publication-reference publ-type="Application" publ-desc="Patent Application Publication">
      <document-id id="121315437">
        <country>US</country>
        <doc-number>20150257668</doc-number>
        <kind>A1</kind>
        <date>20150917</date>
      </document-id>
    </publication-reference>
    <application-reference appl-type="utility">
      <document-id>
        <country>US</country>
        <doc-number>14642782</doc-number>
        <date>20150310</date>
      </document-id>
    </application-reference>
    <application-series-code>14</application-series-code>
    <language-of-filing>eng</language-of-filing>
    <language-of-publication>eng</language-of-publication>
    <dates-of-public-availability date-changed="20150924">
      <unexamined-printed-without-grant>
        <date>20150917</date>
      </unexamined-printed-without-grant>
    </dates-of-public-availability>
    <classifications-ipcr date-changed="20151103">
      <classification-ipcr sequence="1">
        <text>A61B   5/04        20060101AFI20150917BHUS        </text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>A</section>
        <class>61</class>
        <subclass>B</subclass>
        <main-group>5</main-group>
        <subgroup>04</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <action-date>
          <date>20150917</date>
        </action-date>
        <generating-office>
          <country>US</country>
        </generating-office>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
      </classification-ipcr>
      <classification-ipcr sequence="2">
        <text>A61B   5/00        20060101ALI20150917BHUS        </text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>A</section>
        <class>61</class>
        <subclass>B</subclass>
        <main-group>5</main-group>
        <subgroup>00</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <action-date>
          <date>20150917</date>
        </action-date>
        <generating-office>
          <country>US</country>
        </generating-office>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
      </classification-ipcr>
      <classification-ipcr sequence="3">
        <text>A61B   5/0452      20060101ALI20150917BHUS        </text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>A</section>
        <class>61</class>
        <subclass>B</subclass>
        <main-group>5</main-group>
        <subgroup>0452</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <action-date>
          <date>20150917</date>
        </action-date>
        <generating-office>
          <country>US</country>
        </generating-office>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
      </classification-ipcr>
    </classifications-ipcr>
    <classifications-cpc date-changed="20151103">
      <classification-cpc sequence="1">
        <text>A61B   5/04012     20130101 FI20150917BHEP        </text>
        <cpc-version-indicator>
          <date>20130101</date>
        </cpc-version-indicator>
        <section>A</section>
        <class>61</class>
        <subclass>B</subclass>
        <main-group>5</main-group>
        <subgroup>04012</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <action-date>
          <date>20150917</date>
        </action-date>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
      </classification-cpc>
      <classification-cpc sequence="2">
        <text>A61B   5/0006      20130101 LA20150917BHEP        </text>
        <cpc-version-indicator>
          <date>20130101</date>
        </cpc-version-indicator>
        <section>A</section>
        <class>61</class>
        <subclass>B</subclass>
        <main-group>5</main-group>
        <subgroup>0006</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <action-date>
          <date>20150917</date>
        </action-date>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
      </classification-cpc>
      <classification-cpc sequence="3">
        <text>A61B   5/0024      20130101 LA20150917BHEP        </text>
        <cpc-version-indicator>
          <date>20130101</date>
        </cpc-version-indicator>
        <section>A</section>
        <class>61</class>
        <subclass>B</subclass>
        <main-group>5</main-group>
        <subgroup>0024</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <action-date>
          <date>20150917</date>
        </action-date>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
      </classification-cpc>
      <classification-cpc sequence="4">
        <text>A61B   5/0452      20130101 LI20150917BHEP        </text>
        <cpc-version-indicator>
          <date>20130101</date>
        </cpc-version-indicator>
        <section>A</section>
        <class>61</class>
        <subclass>B</subclass>
        <main-group>5</main-group>
        <subgroup>0452</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <action-date>
          <date>20150917</date>
        </action-date>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
      </classification-cpc>
      <classification-cpc sequence="5">
        <text>A61B   5/7267      20130101 LI20151027BHEP        </text>
        <cpc-version-indicator>
          <date>20130101</date>
        </cpc-version-indicator>
        <section>A</section>
        <class>61</class>
        <subclass>B</subclass>
        <main-group>5</main-group>
        <subgroup>7267</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <action-date>
          <date>20151027</date>
        </action-date>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
      </classification-cpc>
    </classifications-cpc>
    <number-of-claims calculated="yes">19</number-of-claims>
    <invention-title id="title_eng" date-changed="20150917" lang="eng" format="original">METHOD FOR DETECTING ABNORMALITIES IN AN ELECTROCARDIOGRAM</invention-title>
    <related-documents date-changed="20150917">
      <provisional-application>
        <document-id>
          <country>US</country>
          <doc-number>61950939</doc-number>
          <date>20140311</date>
        </document-id>
      </provisional-application>
    </related-documents>
    <parties date-changed="20150917">
      <applicants>
        <applicant sequence="1" app-type="applicant">
          <addressbook lang="eng">
            <orgname>ECOLE POLYTECHNIQUE FEDERALE DE LAUSANNE (EPFL)</orgname>
            <role>03</role>
            <address>
              <city>Lausanne</city>
              <country>CH</country>
            </address>
          </addressbook>
        </applicant>
      </applicants>
      <inventors>
        <inventor sequence="1" designation="us-only">
          <addressbook lang="eng">
            <last-name>BRAOJOS LOPEZ</last-name>
            <first-name>Ruben</first-name>
            <address>
              <city>Lausanne</city>
              <country>CH</country>
            </address>
          </addressbook>
        </inventor>
        <inventor sequence="2" designation="us-only">
          <addressbook lang="eng">
            <last-name>ANSALONI</last-name>
            <first-name>Giovanni</first-name>
            <address>
              <city>Bussigny</city>
              <country>CH</country>
            </address>
          </addressbook>
        </inventor>
        <inventor sequence="3" designation="us-only">
          <addressbook lang="eng">
            <last-name>ATIENZA ALONSO</last-name>
            <first-name>David</first-name>
            <address>
              <city>Ecublens</city>
              <country>CH</country>
            </address>
          </addressbook>
        </inventor>
        <inventor sequence="4" designation="us-only">
          <addressbook lang="eng">
            <last-name>RINCON VALLEJOS</last-name>
            <first-name>Francisco</first-name>
            <address>
              <city>Renens</city>
              <country>CH</country>
            </address>
          </addressbook>
        </inventor>
        <inventor sequence="5" designation="us-only">
          <addressbook lang="eng">
            <last-name>MURALI</last-name>
            <first-name>Srinivasan</first-name>
            <address>
              <city>Lausanne</city>
              <country>CH</country>
            </address>
          </addressbook>
        </inventor>
      </inventors>
    </parties>
    <patent-family date-changed="20150917">
      <main-family family-id="173668774">
        <family-member>
          <document-id>
            <country>US</country>
            <doc-number>20150257668</doc-number>
            <kind>A1</kind>
            <date>20150917</date>
          </document-id>
          <application-date>
            <date>20150310</date>
          </application-date>
        </family-member>
      </main-family>
      <complete-family family-id="173668773">
        <family-member>
          <document-id>
            <country>US</country>
            <doc-number>20150257668</doc-number>
            <kind>A1</kind>
            <date>20150917</date>
          </document-id>
          <application-date>
            <date>20150310</date>
          </application-date>
        </family-member>
      </complete-family>
    </patent-family>
  </bibliographic-data>
  <abstract id="abstr_eng" date-changed="20150917" lang="eng" format="original">
    <p id="p-a-00001-en" num="0000">A method for classification of ECG beats into normal and different categories of abnormal beats. The method comprises the following steps, performed on a computing platform: <ul id="ula-00001-en" list-style="none"><li>a. performing a training phase comprising taking as an input one or more ECG beats that are pre-classified into the different categories, with each ECG beat decomposed into multiple features and defining membership functions for each beat category for each feature;</li><li>b. performing an operating phase, wherein (i) for each ECG beat to be classified, decompose the ECG beat into the multiple features; (ii) compute values of each membership function identified in the step of performing the training phase for each feature of the ECG beat for the different categories; (iii) merge the membership function values for all features in an ECG beat in a manner as to get a single beat value for each beat category across the features; (iv) identify a value alpha in the range [0,1], such that the difference between the top two beat values across the different beat categories is more than or equal to the sum of the beat values of all the remaining beat categories multiplied by the value alpha and such that a desired percentage of normal or abnormal beat classification is obtained; (v) if an alpha value can be identified, then classify the beat to belong to the beat that has the highest beat value, otherwise classify the beat as abnormal.</li></ul></p>
  </abstract>
  <legal-data date-changed="20151002">
    <legal-event sequence="1">
      <publication-date>
        <date>20150409</date>
      </publication-date>
      <event-code-1>AS</event-code-1>
      <legal-description>ASSIGNMENT</legal-description>
      <status-identifier>N</status-identifier>
      <docdb-publication-number> US  2015257668A1</docdb-publication-number>
      <docdb-application-id>444511016</docdb-application-id>
      <new-owner>ECOLE POLYTECHNIQUE FEDERALE DE LAUSANNE (EPFL), S</new-owner>
      <free-text-description>ASSIGNMENT OF ASSIGNORS INTEREST;ASSIGNORS:MURALI, SRINIVASAN;BRAOJOS LOPEZ, RUBEN;ANSALONI, GIOVANNI;AND OTHERS;SIGNING DATES FROM 20150320 TO 20150408;REEL/FRAME:035366/0026</free-text-description>
    </legal-event>
  </legal-data>
  <description id="descr_eng" lang="eng" format="original" date-changed="20150917">
    <summary>
      <heading id="h-00001-en" level="1">FIELD OF THE INVENTION</heading>
      <p id="p-00001-en" num="0001">The present invention relates to a method for abnormal beat detection in an Electrocardiogram (ECG) to detect cardiac arrhythmia and other abnormalities.</p>
      <heading id="h-00002-en" level="1">BACKGROUND OF THE INVENTION</heading>
      <p id="p-00002-en" num="0002">Wireless Body Sensor Nodes (WBSNs) are miniaturized, wearable systems able to measure and wirelessly transmit biological signals of patients. A major field of application of WBSNs is the ambulatory acquisition of electrocardiograms (ECGs), which evaluates the electrical activity of the heart. In this context, these devices allow long time monitoring of subjects producing little discomfort and requiring minimal medical supervision.</p>
      <p id="p-00003-en" num="0003">A recent trend in WBSNs, driven by the progress in semiconductor technologies, has been the emergence of “smart” wireless nodes [<b>1</b>]. These smart WBSNs (<figref>FIG. 1</figref>) can, in addition to acquiring and transmitting data wirelessly, perform advanced digital signal processing filtering noise typically corrupting the signals and/or executing an automated diagnosis.</p>
      <p id="p-00004-en" num="0004">In the field of ambulatory electrocardiography, an important early diagnosis step is to separate normal and pathological heartbeats. The benefit of this separation is two-fold: first, it can provide helpful information for speeding up the visual inspections of lengthy recordings by medical staff; second, it can be used to activate a more detailed analysis of only those beats presenting pathological characteristics.</p>
      <p id="p-00005-en" num="0005">The second scenario can lead to two non-obvious, yet substantial, benefits. On the one hand, if a detailed diagnosis is performed off-node, it can be desirable to transmit or store only pathological beats on the WBSN, greatly reducing either the energy employed for wireless transmission or the data storage requirements, respectively. On the other hand, even if the analysis of beats is executed on the wireless node, computation effort can be reduced by activating it only when abnormal beats are detected, increasing energy efficiency.</p>
      <p id="p-00006-en" num="0006">While off-line algorithms have been proposed to classify the different heartbeat morphologies [2][3], their real-time implementation poses a considerable challenge on WBSN platforms, due to their high computational requirements.</p>
      <p id="p-00007-en" num="0007">A neuro-fuzzy classifier (NFC) approach [4] is instead potentially a good candidate for this application. Its simple feed-forward structure makes it eligible to be optimized for, and executed on, the constrained resources typically present on WBSNs.</p>
      <p id="p-00008-en" num="0008">An important factor to consider is the high dimensionality of the heartbeat representation problem as, for every beat, tens of samples before and after the R peak of the QRS complex peak have to be considered to perform a reliable classification.</p>
      <p id="p-00009-en" num="0009">To effectively address this problem, in the method according to the invention enables to classify ECG beats using a method based on random projections (RPs) that can lead to reduction in input size. The approximation error introduced by random projections is theoretically bounded, nonetheless empirical evidence shows that certain projections perform better than others. Our experiments show that even a rather simple optimization, such as the one performed by a genetic algorithm in few generations, can find a proper projection to obtain optimal classification results. In one embodiment of the invention, the method includes the RP-classifier, a filtering stage and a peak detector, used to isolate beats. In one embodiment, three-lead delineation is used instead adopted as an example of detailed analysis, and is activated by the classifier only for beats identified as pathological.</p>
      <p id="p-00010-en" num="0010">Test heartbeats were retrieved from the MIT-BIH Arrhythmia database [5], considering all beats presenting three different morphologies: normal sinus rhythms, left bundle branch blocks and premature ventricular contractions. Experimental results show that the proposed methodology can identify more than 97% of abnormal beats, while using a small fraction of the available SoC memory and computing resources.</p>
      <p id="p-00011-en" num="0011">Neuro-fuzzy classifiers (NFCs) [6] have been extensively studied in the literature. Their ability to explicitly express uncertainty in classification, given by the employed fuzzy values, makes them particularly well suited to the problem of heartbeat classification, as proposed in [7].</p>
      <p id="p-00012-en" num="0012">NFCs can be effectively trained using established methods, the most common being the gradient descent algorithm described in [6] and the scale conjugate gradient introduced in [8] and [9], which is employed in this work. The approach is both computationally simpler and presenting lower memory requirements than comparable methods, like the ones based on support vector machines [2] and linear discriminants [10]. Therefore, it is more suitable for execution in embedded WBSNs.</p>
      <p id="p-00013-en" num="0013">Several state-of-the-art strategies for neuro-fuzzy classification of ECGs can be distinguished based on the methodology employed to extract the features of individual heartbeats generating the classifier input. Solutions to the features extraction problem include the ones based on Independent or Principal component analysis (ICA [11]/PCA, [3]), Discrete Wavelets Transform (DWT [12]) and Discrete Cosine Transform (DCT [4]). As opposed to the method disclosed in this invention, these methods demand a computation effort not compatible with WBSN resources.</p>
      <p id="p-00014-en" num="0014">A different approach, based on detection of morphological features, is presented in [13]; it nevertheless requires a detailed analysis of heartbeats before classification, conversely to our goal of early identification of pathological beats.</p>
      <heading id="h-00003-en" level="1">SUMMARY OF THE INVENTION</heading>
      <p id="p-00015-en" num="0015">In a first aspect, the invention provides a method for classification of ECG beats into normal and different categories of abnormal beats. The method comprises the following steps, performed on a computing platform <ul id="ul-00001-en" list-style="none"><li><ul id="ul-00002-en" list-style="none"><li>a. performing a training phase comprising         <ul id="ul-00003-en" list-style="none"><li>taking as an input one or more ECG beats that are pre-classified into the different categories, with each ECG beat decomposed into multiple features and</li><li>defining membership functions for each beat category for each feature;</li></ul></li><li>b. performing an operating phase, wherein         <ul id="ul-00004-en" list-style="none"><li>(i) for each ECG beat to be classified, decompose the ECG beat into the multiple features;</li><li>(ii) compute values of each membership function identified in the step of performing the training phase for each feature of the ECG beat for the different categories;</li><li>(iii) merge the membership function values for all features in an ECG beat in a manner as to get a single beat value for each beat category across the features;</li><li>(iv) identify a value alpha in the range [0,1], such that the difference between the top two beat values across the different beat categories is more than or equal to the sum of the beat values of all the remaining beat categories multiplied by the value alpha and such that a desired percentage of normal or abnormal beat classification is obtained;</li><li>(v) if an alpha value can be identified, then classify the beat to belong to the beat that has the highest beat value, otherwise classify the beat as abnormal.</li></ul></li></ul></li></ul></p>
      <p id="p-00016-en" num="0025">In a preferred embodiment of the invention, the ECG beat is decomposed into multiple features, and the feature set vector is reduced by multiplying the vector by a matrix such that the output is a vector with fewer entries.</p>
      <p id="p-00017-en" num="0026">In a further preferred embodiment of the invention the matrix is composed such that the entries are randomly assigned a value of {+1, −1, 0} with a pre-defined probability values of {⅙, ⅙, ⅔}.</p>
      <p id="p-00018-en" num="0027">In a further preferred embodiment of the invention, the method further comprises generating multiple matrices by starting from a set of initial random matrices and using a genetic algorithm; using the newly reduced features in the step of performing the operating phase; and choosing from the generated multiple matrices the matrix that has the best performance in achieving the desired percentage of classification of normal and abnormal beats for the step of performing the operating phase.</p>
      <p id="p-00019-en" num="0028">In a further preferred embodiment of the invention the step of performing the operating phase is run on an embedded micro-controller, such that the floating point operations involved are converted into integer operations.</p>
      <p id="p-00020-en" num="0029">In a further preferred embodiment of the invention each of the membership functions is a Guassian function.</p>
      <p id="p-00021-en" num="0030">In a further preferred embodiment of the invention the step of performing the operating phase is run on an embedded micro-controller, such that the result of the step of merging the membership function values for all features in an ECG beat involves an approximation by a combination of linear functions.</p>
      <p id="p-00022-en" num="0031">In a further preferred embodiment of the invention exactly four linear functions are used to fit the Gaussian function.</p>
      <p id="p-00023-en" num="0032">In a further preferred embodiment of the invention the step of merging the membership function values is performed by multiplying the membership values together.</p>
      <p id="p-00024-en" num="0033">In a further preferred embodiment of the invention the step of merging the membership function values is performed by multiplying the membership values together, and the membership function values are scaled uniformly by a constant value, in order to avoid the multiplied values to reach 0 when converted into integer values when used on an embedded processor.</p>
      <p id="p-00025-en" num="0034">In a further preferred embodiment of the invention the step of merging the membership function values is performed by multiplying the membership values together, and the membership function values are scaled uniformly by a constant value, in order to avoid the multiplied values to reach 0 when converted into integer values when used on an embedded processor.</p>
      <p id="p-00026-en" num="0035">In a further preferred embodiment of the invention the scaling by a constant value is achieved by left shifting the binary equivalent of the values across all the membership functions by a constant amount.</p>
      <p id="p-00027-en" num="0036">In a further preferred embodiment of the invention the scaling by a constant value is achieved by left shifting the binary equivalent of the values across all the membership functions by a constant amount.</p>
      <p id="p-00028-en" num="0037">In a further preferred embodiment of the invention additional values of fiducial points of an ECG are added to decomposed features.</p>
      <p id="p-00029-en" num="0038">In a further preferred embodiment of the invention the fiducial points comprise a starting point, a peak or end of P wave, a QRS complex, a R-peak and a T wave of the ECG.</p>
      <p id="p-00030-en" num="0039">In a further preferred embodiment of the invention distances between the fiducial points are added to a sample space.</p>
      <p id="p-00031-en" num="0040">In a second aspect, the invention provides a Wireless Body Sensor Nodes device that comprises a code in its memory, that when executed by a processor of the device causes the device to execute a method for classification of ECG beats into normal and different categories of abnormal beats. The method comprising the following steps, <ul id="ul-00005-en" list-style="none"><li><ul id="ul-00006-en" list-style="none"><li>a. performing a training phase comprising         <ul id="ul-00007-en" list-style="none"><li>taking as an input one or more ECG beats that are pre-classified into the different categories, with each ECG beat decomposed into multiple features</li><li>defining membership functions for each beat category for each feature;</li></ul></li><li>b. performing an operating phase, wherein         <ul id="ul-00008-en" list-style="none"><li>(i) for each ECG beat to be classified, decompose the ECG beat into the multiple features;</li><li>(ii) compute values of each membership function identified in the step of performing the training phase for each feature of the ECG beat for the different categories;</li><li>(iii) merge the membership function values for all features in an ECG beat in a manner as to get a single beat value for each beat category across the features;</li><li>(iv) identify a value alpha in the range [0,1], such that the difference between the top two beat values across the different beat categories is more than or equal to the sum of the beat values of all the remaining beat categories multiplied by the value alpha and such that a desired percentage of normal or abnormal beat classification is obtained;</li><li>(v) if an alpha value can be identified, then classify the beat to belong to the beat that has the highest beat value, otherwise classify the beat as abnormal.</li></ul></li></ul></li></ul></p>
    </summary>
    <description-of-drawings>
      <heading id="h-00004-en" level="1">BRIEF DESCRIPTION OF THE FIGURES AND TABLES</heading>
      <p id="p-00032-en" num="0050">The invention will be better understood from the description of preferred embodiments and in light of the figures and tables, wherein</p>
      <p id="p-00033-en" num="0051">
        <figref>FIG. 1</figref> contains a block scheme of a WBSN platform;</p>
      <p id="p-00034-en" num="0052">
        <figref>FIG. 2</figref> contains a schematic representation of a Random Projection (RP) based fuzzy classification framework: PC-based training (top) and WBSN execution (bottom);</p>
      <p id="p-00035-en" num="0053">
        <figref>FIG. 3</figref>: illustrates a three layers Neuro-Fuzzy Classifier (NFC);</p>
      <p id="p-00036-en" num="0054">
        <figref>FIG. 4</figref> contains a graph of a inear approximation of Gaussian MFs;</p>
      <p id="p-00037-en" num="0055">
        <figref>FIG. 5</figref> illustrates a two-step procedure of beat classification—the second step of activating signal delineation is performed only when an abnormal beat is detected;</p>
    </description-of-drawings>
    <detailed-desc>
      <p id="p-00038-en" num="0056">table I contains size and composition of the two training sets and of the test set of ECG Heartbeats; and</p>
      <p id="p-00039-en" num="0057">table II contains Normal Discard Rate (NDR) on test_set for a fixed Abnormal Recognition Rate (ARR) of 97%, varying the number of coefficients.</p>
      <heading id="h-00005-en" level="1">DESCRIPTION OF PREFERRED EMBODIMENTS OF THE INVENTION</heading>
      <p id="p-00040-en" num="0058">The training and test phases of the classification framework, which are illustrated in <figref>FIG. 2</figref>, have multiple and different constraints. On the one side, the training phase is performed off-line, on a host (PC) platform and using high-precision (floating-point) data representation to obtain the most accurate framework set-up. On the other side, the test phase is executed on an embedded WBSN, being therefore tightly constrained in memory footprint and run-time, admitting only integer arithmetic and avoiding exponential operations.</p>
      <p id="p-00041-en" num="0059">It is therefore mandatory to transform the classifier, after training and before execution, to lower its computational requirements according to the embedded platform capabilities. The following description details the proposed method to realize this step, the algorithm used for off-line training of the RP matrix and the NFC, and finally, the result of our complete framework that is a classifier which is both accurate and efficient.</p>
      <p id="p-00042-en" num="0060">A. Training Phase</p>
      <p id="p-00043-en" num="0061">Random Projection.</p>
      <p id="p-00044-en" num="0062">The first step of our proposed training phase is the generation of a k×d Achlioptas matrix (P), where d is the number of digital samples acquired for each heartbeat and k is the number of desired coefficients in the random projection, with k&lt;&lt;d. P elements are defined [14] as:</p>
      <p id="p-00045-en" num="0000">
        <maths id="maths-00001-en" num="00001">
          <math overflow="scroll">
            <mrow>
              <msub>
                <mi>P</mi>
                <mrow>
                  <mi>k</mi>
                  <mo>,</mo>
                  <mi>d</mi>
                </mrow>
              </msub>
              <mo>=</mo>
              <mrow>
                <mo>{</mo>
                <mtable>
                  <mtr>
                    <mtd>
                      <mrow>
                        <mo>+</mo>
                        <mn>1</mn>
                      </mrow>
                    </mtd>
                    <mtd>
                      <mrow>
                        <mi>with</mi>
                        <mo></mo>
                        <mstyle>
                          <mspace width="0.8em" height="0.8ex" />
                        </mstyle>
                        <mo></mo>
                        <mi>probability</mi>
                        <mo></mo>
                        <mstyle>
                          <mspace width="0.8em" height="0.8ex" />
                        </mstyle>
                        <mo></mo>
                        <mfrac>
                          <mn>1</mn>
                          <mn>6</mn>
                        </mfrac>
                      </mrow>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mrow>
                        <mo>-</mo>
                        <mn>1</mn>
                      </mrow>
                    </mtd>
                    <mtd>
                      <mrow>
                        <mi>with</mi>
                        <mo></mo>
                        <mstyle>
                          <mspace width="0.8em" height="0.8ex" />
                        </mstyle>
                        <mo></mo>
                        <mi>probability</mi>
                        <mo></mo>
                        <mstyle>
                          <mspace width="0.8em" height="0.8ex" />
                        </mstyle>
                        <mo></mo>
                        <mfrac>
                          <mn>1</mn>
                          <mn>6</mn>
                        </mfrac>
                      </mrow>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mn>0</mn>
                    </mtd>
                    <mtd>
                      <mrow>
                        <mi>with</mi>
                        <mo></mo>
                        <mstyle>
                          <mspace width="0.8em" height="0.8ex" />
                        </mstyle>
                        <mo></mo>
                        <mi>probability</mi>
                        <mo></mo>
                        <mstyle>
                          <mspace width="0.8em" height="0.8ex" />
                        </mstyle>
                        <mo></mo>
                        <mfrac>
                          <mn>2</mn>
                          <mn>3</mn>
                        </mfrac>
                      </mrow>
                    </mtd>
                  </mtr>
                </mtable>
              </mrow>
            </mrow>
          </math>
          <img id="img-00001-en" wi="N/A" he="N/A" file="US20150257668A1_00006.PNG" alt="embedded image" img-content="math" img-format="png" inline="yes" original="US20150257668A1-20150917-M00001.TIF" />
        </maths>
      </p>
      <p id="p-00046-en" num="0063">Each line of P indicates which elements of an input vector v have to be added (possibly negated) to derive the corresponding vector u of randomly-projected coefficients: u=Pv.</p>
      <p id="p-00047-en" num="0064">Neuro-Fuzzy Classifier.</p>
      <p id="p-00048-en" num="0065">The coefficients are the inputs to the multi-layered NFC (<figref>FIG. 3</figref>). Its first membership layer employs Membership Functions (MFs) to compute, for each coefficient k, a membership grade μ for each of the classes of beats l. In one embodiment of the application, 3 classes are used: normal beats (N), left branch block (L) and premature ventricular contraction (V). The classes can be extended to include several other different beat types, such as atrial fibrillation, ventricular tachycardia, bradycardia and so forth. During the training phase, MFs are gaussian curves, defined by their center c and variance a:</p>
      <p id="p-00049-en" num="0000">
        <maths id="maths-00002-en" num="00002">
          <math overflow="scroll">
            <mrow>
              <mrow>
                <msub>
                  <mi>μ</mi>
                  <mrow>
                    <mi>k</mi>
                    <mo>,</mo>
                    <mi>l</mi>
                  </mrow>
                </msub>
                <mo></mo>
                <mrow>
                  <mo>(</mo>
                  <msub>
                    <mi>u</mi>
                    <mi>k</mi>
                  </msub>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mo>=</mo>
              <mrow>
                <mi>exp</mi>
                <mo></mo>
                <mrow>
                  <mo>(</mo>
                  <mfrac>
                    <mrow>
                      <mo>-</mo>
                      <msup>
                        <mrow>
                          <mo>(</mo>
                          <mrow>
                            <msub>
                              <mi>u</mi>
                              <mi>k</mi>
                            </msub>
                            <mo>-</mo>
                            <msub>
                              <mi>c</mi>
                              <mrow>
                                <mi>k</mi>
                                <mo>,</mo>
                                <mi>l</mi>
                              </mrow>
                            </msub>
                          </mrow>
                          <mo>)</mo>
                        </mrow>
                        <mn>2</mn>
                      </msup>
                    </mrow>
                    <mrow>
                      <mn>2</mn>
                      <mo></mo>
                      <msubsup>
                        <mi>σ</mi>
                        <mrow>
                          <mi>k</mi>
                          <mo>,</mo>
                          <mi>l</mi>
                        </mrow>
                        <mn>2</mn>
                      </msubsup>
                    </mrow>
                  </mfrac>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </math>
          <img id="img-00002-en" wi="N/A" he="N/A" file="US20150257668A1_00007.PNG" alt="embedded image" img-content="math" img-format="png" inline="yes" original="US20150257668A1-20150917-M00002.TIF" />
        </maths>
        <maths id="maths-00003-en" num="00002.2">
          <math overflow="scroll">
            <mrow>
              <mrow>
                <mi>where</mi>
                <mo></mo>
                <mstyle>
                  <mspace width="0.8em" height="0.8ex" />
                </mstyle>
                <mo></mo>
                <mi>l</mi>
              </mrow>
              <mo>∈</mo>
              <mrow>
                <mrow>
                  <mo>{</mo>
                  <mrow>
                    <mi>N</mi>
                    <mo>,</mo>
                    <mi>V</mi>
                    <mo>,</mo>
                    <mi>L</mi>
                  </mrow>
                  <mo>}</mo>
                </mrow>
                <mo>.</mo>
              </mrow>
            </mrow>
          </math>
        </maths>
      </p>
      <p id="p-00050-en" num="0066">In the subsequent fuzzification layer, the membership grades of all coefficients for each class are multiplied:</p>
      <p id="p-00051-en" num="0000">[in-line-formulae]<i>f</i><sub>l</sub>=<sub>k</sub>Π<sub>μ</sub><sub><sub2>k,l</sub2></sub>.[/in-line-formulae]</p>
      <p id="p-00052-en" num="0067">The resulting fuzzy value expresses how strongly an examined heartbeat belongs to that specific class: the larger the value (with respect to the values of the other classes), the higher the confidence in the correctness of the assignment.</p>
      <p id="p-00053-en" num="0068">The third defuzzification layer of the NFC marks each beat as either normal or pathological, by considering the first and second maximum of the fuzzy values (M1<sub>f</sub>, M2<sub>f</sub>) and their sum</p>
      <p id="p-00054-en" num="0000">[in-line-formulae]<i>S=Σ</i><sub>f</sub><sub><sub2>l</sub2></sub>. If (<i>M</i>1<sub>f</sub><i>−M</i>2<i>f</i>)≧α<sub>train</sub><i>S </i>[/in-line-formulae]</p>
      <p id="p-00055-en" num="0069">(with α<sub>train </sub>in [0, 1]),</p>
      <p id="p-00056-en" num="0070">
        <sub>l </sub>the beat is assigned to the class with maximum fuzzy value (N, V, L). Otherwise, the beat is marked as Unknown (U). V, L, U beats are considered as possibly pathological, while N beats are marked as normal.</p>
      <p id="p-00057-en" num="0071">The choice of a proper defuzzification coefficient α<sub>train </sub>gives the flexibility to unbalance the classifier training process, fixing the percentage of abnormal beats incorrectly classified as N. The performance (score) of the trained classifier is then the corresponding percentage of normal beats correctly detected.</p>
      <p id="p-00058-en" num="0072">Two-Step Training:</p>
      <p id="p-00059-en" num="0073">The aim of the training is to search for high-performance P matrix and MFs. The algorithm starts from an initial population of random projection matrices P<sub>pop</sub>, optimizing the MFs of the related classifier over a first set of projected heartbeats (training_set 1) using the scale conjugate method [8]. The performance of the random projection is then the score of the associated NFC over a second training set of beats (training_set<sub>—</sub>2).</p>
      <p id="p-00060-en" num="0074">In one embodiment, to optimize the projection, we use a genetic algorithm that considers each P in P<sub>pop </sub>as chromosomes and, performing crossover and mutation operations on them, derive higher-performance candidates. For the experiments presented herein under, we employed an initial population of 20 matrices and let the algorithm run for 30 generations.</p>
      <p id="p-00061-en" num="0075">B. Resource-Constrained Optimization Phase</p>
      <p id="p-00062-en" num="0076">The optimized projection and the trained classifier cannot be employed “as they are” in a WBSN platform. A first consideration is that data must be represented as integers, as opposed to the floating point format used in the training phase.</p>
      <p id="p-00063-en" num="0077">Then, several other elements are particularly critical. First, gaussian MFs employed in the NFC make use of exponential operations, which are not easily (or not at all) implementable in embedded platforms. Second, the NFC fuzzification layer must be analyzed to prevent overflows when performing the product operation. Finally, the memory required to store the random projection matrix can exceed the WBSN resources.</p>
      <p id="p-00064-en" num="0078">Membership Functions Linearization.</p>
      <p id="p-00065-en" num="0079">Given their center c and standard deviation σ, gaussian MFs are approximated to the integer range [0, (2<sup>16</sup>−1)] during the optimization step using four segments:</p>
      <p id="p-00066-en" num="0000">
        <maths id="maths-00004-en" num="00003">
          <math overflow="scroll">
            <mrow>
              <mrow>
                <msub>
                  <mi>MF</mi>
                  <mi>lin</mi>
                </msub>
                <mo></mo>
                <mrow>
                  <mo>(</mo>
                  <mi>x</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mo>=</mo>
              <mrow>
                <mo>{</mo>
                <mtable>
                  <mtr>
                    <mtd>
                      <mn>0</mn>
                    </mtd>
                    <mtd>
                      <mrow>
                        <mrow>
                          <mi>if</mi>
                          <mo></mo>
                          <mstyle>
                            <mspace width="0.8em" height="0.8ex" />
                          </mstyle>
                          <mo></mo>
                          <mrow>
                            <mo></mo>
                            <mrow>
                              <mi>c</mi>
                              <mo>-</mo>
                              <mi>x</mi>
                            </mrow>
                            <mo></mo>
                          </mrow>
                        </mrow>
                        <mo>≥</mo>
                        <mrow>
                          <mn>4</mn>
                          <mo></mo>
                          <mstyle>
                            <mspace width="0.3em" height="0.3ex" />
                          </mstyle>
                          <mo></mo>
                          <mi>S</mi>
                        </mrow>
                      </mrow>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mn>1</mn>
                    </mtd>
                    <mtd>
                      <mrow>
                        <mrow>
                          <mi>if</mi>
                          <mo></mo>
                          <mstyle>
                            <mspace width="0.8em" height="0.8ex" />
                          </mstyle>
                          <mo></mo>
                          <mn>4</mn>
                          <mo></mo>
                          <mstyle>
                            <mspace width="0.3em" height="0.3ex" />
                          </mstyle>
                          <mo></mo>
                          <mi>S</mi>
                        </mrow>
                        <mo>&gt;</mo>
                        <mrow>
                          <mo></mo>
                          <mrow>
                            <mi>c</mi>
                            <mo>-</mo>
                            <mi>x</mi>
                          </mrow>
                          <mo></mo>
                        </mrow>
                        <mo>≥</mo>
                        <mrow>
                          <mn>2</mn>
                          <mo></mo>
                          <mstyle>
                            <mspace width="0.3em" height="0.3ex" />
                          </mstyle>
                          <mo></mo>
                          <mi>S</mi>
                        </mrow>
                      </mrow>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mrow>
                        <mrow>
                          <mi>lin</mi>
                          <mo>.</mo>
                          <mi>approx</mi>
                        </mrow>
                        <mo></mo>
                        <mstyle>
                          <mspace width="0.3em" height="0.3ex" />
                        </mstyle>
                        <mo></mo>
                        <mn>1</mn>
                      </mrow>
                    </mtd>
                    <mtd>
                      <mrow>
                        <mrow>
                          <mi>if</mi>
                          <mo></mo>
                          <mstyle>
                            <mspace width="0.8em" height="0.8ex" />
                          </mstyle>
                          <mo></mo>
                          <mn>2</mn>
                          <mo></mo>
                          <mstyle>
                            <mspace width="0.3em" height="0.3ex" />
                          </mstyle>
                          <mo></mo>
                          <mi>S</mi>
                        </mrow>
                        <mo>&gt;</mo>
                        <mrow>
                          <mo></mo>
                          <mrow>
                            <mi>c</mi>
                            <mo>-</mo>
                            <mi>x</mi>
                          </mrow>
                          <mo></mo>
                        </mrow>
                        <mo>≥</mo>
                        <mi>S</mi>
                      </mrow>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mrow>
                        <mrow>
                          <mi>lin</mi>
                          <mo>.</mo>
                          <mi>approx</mi>
                        </mrow>
                        <mo></mo>
                        <mstyle>
                          <mspace width="0.3em" height="0.3ex" />
                        </mstyle>
                        <mo></mo>
                        <mn>2</mn>
                      </mrow>
                    </mtd>
                    <mtd>
                      <mrow>
                        <mrow>
                          <mi>if</mi>
                          <mo></mo>
                          <mstyle>
                            <mspace width="0.8em" height="0.8ex" />
                          </mstyle>
                          <mo></mo>
                          <mi>S</mi>
                        </mrow>
                        <mo>&gt;</mo>
                        <mrow>
                          <mo></mo>
                          <mrow>
                            <mi>c</mi>
                            <mo>-</mo>
                            <mi>x</mi>
                          </mrow>
                          <mo></mo>
                        </mrow>
                      </mrow>
                    </mtd>
                  </mtr>
                </mtable>
              </mrow>
            </mrow>
          </math>
          <img id="img-00003-en" wi="N/A" he="N/A" file="US20150257668A1_00008.PNG" alt="embedded image" img-content="math" img-format="png" inline="yes" original="US20150257668A1-20150917-M00003.TIF" />
        </maths>
      </p>
      <p id="p-00067-en" num="0080">where MF<sub>lin </sub>is the linearized MF and S=2.35σ. The linear approximation segments are graphically represented in <figref>FIG. 4</figref>. This formulation has the desirable property to be positive in a large range; hence, it is rare that a fuzzy value becomes 0 after the defuzzification (product) classifier stage.</p>
      <p id="p-00068-en" num="0081">Fuzzification/Defuzzification:</p>
      <p id="p-00069-en" num="0082">Only the ratio between the fuzzy coefficients f<sub>l</sub>, as opposed to their value, is relevant for the defuzzification layer. From this observation stems the opportunity to optimize the fuzzification step, retaining the maximum precision given the 32-bit representation used for the results of the defuzzification products. In one embodiment of the application, the membership grades μ<sub>k,l </sub>related to the two first coefficients are multiplied for each of the three classes. The three resulting numbers are left-shifted to the maximum amount so that none of them overflow and then the rightmost 16 bits are discarded. All subsequent membership grades are then processed in a similar fashion, obtaining the fuzzy values of the beats for the different classes.</p>
      <p id="p-00070-en" num="0083">Defuzzification marks each beat as normal or pathological, much like in the training phase. The chosen implementation does not employ divisions, and can therefore be efficiently implemented in WBSNs. Moreover, it is possible to tune the defuzzification coefficient α<sub>test </sub>independently of the α<sub>train </sub>chosen during the training phase (described in Section VI-A), giving the opportunity to adjust the ratio of detected normal and abnormal beats.</p>
      <p id="p-00071-en" num="0084">Random Projection matrix representation. The P matrix is generated in such a way that its elements only assume three values (+1, −1 and 0). In one embodiment, we use a compact representation where each element is coded using two bits, which requires ¼ of the memory with respect to a corresponding matrix of 8-bits values.</p>
      <p id="p-00072-en" num="0085">Downsampling can also be applied to reduce the memory occupied by the random projection matrix. If, for example, one every four samples of the acquired signal is considered, the size of the matrix is reduced by a factor of four.</p>
      <heading id="h-00006-en" level="1">EXPERIMENTAL RESULTS</heading>
      <heading id="h-00007-en" level="1">Experimental Setup</heading>
      <p id="p-00073-en" num="0086">To evaluate the proposed RP-based ECG classifier, we investigated its performance when evaluating the normal (N), ventricular contraction (V) and left branch block (L) beats present in the MIT-BIH Arrhythmia Database recordings, available on the Physiobank website [5].</p>
      <p id="p-00074-en" num="0087">For each beat, classification in either the normal or pathological classes is performed. As mentioned herein above, the goal of the classifier is to recognize abnormal beats, activating only in these cases a detailed analysis such as the three-lead delineation, as shown in <figref>FIG. 5</figref>. In this context, figures of merit of the classifier are the Normal Discard Rate (NDR) and Abnormal Recognition Rate (ARR). NDR assesses the rate of normal beats that are correctly identified as such and thus discarded.</p>
      <p id="p-00075-en" num="0088">Complementarily, ARR reports the percentage of abnormal beats that correctly activate the delineation block. Two randomly-selected excerpts of the database where used for training the NFC and optimizing the random projection matrix, respectively. The first training set is smaller than the second because training of the NFC is more computationally complex than its evaluation; in this way, it was possible to retrieve “good” solutions in a reasonable time. The test_set comprises all N, V, L beats present in the database (the composition of the sets is shown in Table I). Across experiments, the defuzzification coefficient α<sub>train </sub>was chosen to have a minimum ARR of at least 97% on training_set<sub>—</sub>2.</p>
      <p id="p-00076-en" num="0089">ECG recordings on the database are acquired at 360 Hz; we define each heartbeat as spanning 100 samples before and 100 samples after its peak. Peaks are automatically detected using a wavelet-based technique, firstly proposed in [1], which decompose the input signals in four dyadic scales at different frequencies, retrieving the peak as the zero-crossing point on the first scale in-between couples of maximum-minimum points across scales.</p>
      <p id="p-00077-en" num="0090">Evaluation of a Suitable RP Coefficients Number</p>
      <p id="p-00078-en" num="0091">A first important design choice is to determine the number of random projection coefficients. A larger coefficient set impacts both the size of the random projection matrix and the complexity of the NFC, the decision being therefore a trade-off between classification accuracy and real-time performance (run-time and required memory). To explore this aspect, we trained and tested the framework with a number of coefficients ranging from 8 to 32. Table II reports the NDR corresponding to a minimum ARR of 97% on the test_set. For comparison, the table also presents the classification performance obtained using the off-line Principal Component Analysis (PCA) algorithm proposed in [3] to reduce the representation dimensionality.</p>
      <p id="p-00079-en" num="0092">Values in the table are classified in three settings. The first row (NDR−PC) refers to a PC-based implementation were no approximation is performed: it therefore uses floating point data representation and gaussian membership functions. The second row (NDR−WBSN) instead shows the performance of the corresponding WBSN version, employing linearized MFs, integer data and a sampling rate of 90 Hz (a four-times downsampling of the original recordings). In the third row (PCA−PC), coefficients are derived from PCA instead of random projections.</p>
      <p id="p-00080-en" num="0093">Two conclusions can be drawn from these experiments. Firstly, only a small number of randomly-projected coefficients are sufficient to achieve a NDR of over 90%. Actually, increasing this value from 8 to 32 does not benefit classification in a tangible way. Secondly, the difference between NDR−PCA, NDR−PC and NDR−WBSN is rather small, being always in the range of few percentage points. This shows that the proposed methodology does not penalise accuracy, even if the computation effort required in the three cases differs greatly.</p>
      <p id="p-00081-en" num="0094">Extensions</p>
      <p id="p-00082-en" num="0095">While the embodiments present beat classification into normal, ventricular contraction and left bundle branch block and unknown categories. The presented methods can be easily extended to detect several other abnormal beat categories as well, by expanding the number of membership functions used, and merging them such that one value is obtained for a beat for each category.</p>
      <p id="p-00083-en" num="0096">The classifier approach can be extended to handle rhythm abnormalities that are detected based on the distances between the fiducial points. Instead of fitting the samples extracted from the ECG beat to membership functions, in this case, the distance between the ECG fiducial points (such as the length of the PQ segment, QRS complex size and distance, distance of QT, TP, ST, RT segments) can be added as elements to the classifier to build the membership functions. Other information such as the presence or absence or P wave, QRS wave or T wave can also be added of the set of extracted parameters. The parameters could also include abnormal waveforms, such as the inversion of T wave or the presence of a J wave. Many arrhythmias are detected based on the values of these segments or based on the presence/absence of the mentioned waves.</p>
      <p id="p-00084-en" num="0097">Many ECG abnormalities appear only when multiple beats are analyzed. For example, bradycardia or tachycardia can be detected by finding the distance between consecutive R peaks of two or more ECG beats. The classification method can be easily extended to cover these cases as well. The parameters given to the classifier, apart from the extracted ECG samples and the distance between the fiducuial points, can also include distance between fiducial points across multiple ECG beats (for example, RR interval across two or more beats). The information can also include Heart Rate Variability (HRV) analysis across multiple beats. In fact, the information can also include frequency domain measures (such as the frequency components of RR interval variations), along with the time domain measures. Also, multiple ECG beats can be collected and an ensemble average or a different measure of merging of the ECG beats can be performed, before extracting the samples or the other fiducial point information for the classification process.</p>
      <heading id="h-00008-en" level="1">REFERENCES</heading>
      <p id="p-00085-en" num="0000">
        <ul id="ul-00009-en" list-style="none">
          <li>[1] F. Rincon, J. Recas, N. Khaled, and D. Atienza, “Development and evaluation of multilead wavelet-based ECG delineation algorithms for embedded wireless sensor nodes,” <i>Information Technology in Biomedicine, IEEE Transactions on</i>, vol. 15, no. 6, pp. 854-863, November 2011.</li>
          <li>[2] X. Jiang, L. Zhang, Q. Zhao, and S. Albayrak, “ECG arrhythmias recognition system based on independent component analysis feature extraction,” in <i>TENCON </i>2006. 2006 <i>IEEE Region </i>10 <i>Conference</i>, November 2006, pp. 1-4.</li>
          <li>[3] R. Ceylan and Y. Ozbay, “Comparison of FCM, PCA and WT techniques for classification ECG arrhythmias using artificial neural network,” <i>Expert Systems with Applications</i>, vol. 33, no. 2, pp. 286-295, 2007.</li>
          <li>[4] V.-E. Neagoe, I.-F. Iatan, and S. Grunwald, “A neuro-fuzzy approach to classification of ECG signals for ischemic heart disease diagnosis,” in <i>American Medical Informatics Association Annual Symposium, </i>2003, pp. 494-498. [5] PhysioBank. [Online]. Available: www.physionet.org/physiobank/</li>
          <li>[6] C.-T. Sun and J.-S. Jang, “A neuro-fuzzy classifier and its applications,” in <i>Fuzzy Systems, </i>1993<i>., Second IEEE International Conference on</i>, 1993, pp. 94-98 vol. 1.</li>
          <li>[7] R. Ceylan, Y. Ozbay, and B. Karlik, “A novel approach for classification of ECG arrhythmias: Type-2 fuzzy clustering neural network,” <i>Expert Systems with Applications</i>, vol. 36, no. 3, Part 2, pp. 6721-6726, August 2009.</li>
          <li>[8] M. F. Moller, “A scaled conjugate gradient algorithm for fast supervised learning,” <i>Neural Networks</i>, vol. 6, no. 4, pp. 525-533, 1993.</li>
          <li>[9] B. Cetisli and A. Barkana, “Speeding up the scaled conjugate gradient algorithm and its application in neuro-fuzzy classifier training,” <i>Soft Computing</i>, vol. 14, no. 4, pp. 365-378, October 2009.</li>
          <li>[10] P. de Chazal, M. O'Dwyer, and R. Reilly, “Automatic classification of heartbeats using ECG morphology and heartbeat interval features,” <i>Biomedical Engineering, IEEE Transactions on</i>, vol. 51, no. 7, pp. 1196-1206, July 2004.</li>
          <li>[11] S.-N. Yu and K.-T. Chou, “Integration of independent component analysis and neural networks for ECG beat classification,” <i>Expert Systems with Applications</i>, vol. 34, no. 4, pp. 2841-2846, May 2008.</li>
          <li>[12] I. Guler and E. D. Ubeyli, “ECG beat classifier designed by combined neural network model,” <i>Pattern Recognition</i>, vol. 38, no. 2, pp. 199-208, February 2005.</li>
          <li>[13] C. Ye, M. Coimbra, and B. Vijaya Kumar, “Arrhythmia detection and classification using morphological and dynamic features of ECG signals,” in <i>Engineering in Medicine and Biology Society </i>(<i>EMBC</i>), 2010 <i>Annual International Conference of the IEEE</i>, September 2010, pp. 1918-1921.</li>
          <li>[14] D. Achlioptas, “Database-friendly random projections: Johnson-Lindenstrauss with binary coins,” <i>Journal of Computer and System Sciences</i>, vol. 66, no. 4, pp. 671-687, June 2003.</li>
        </ul>
      </p>
    </detailed-desc>
  </description>
  <claims id="claims_eng" lang="eng" format="original" date-changed="20150917">
    <claim num="1" id="clm-00001-en" independent="true">
      <claim-text>
        <b>1</b>. A method for classification of ECG beats into normal and different categories of abnormal beats, the method comprising the following steps, performed on a computing platform
<claim-text>a. performing a training phase comprising
<claim-text>taking as an input one or more ECG beats that are pre-classified into the different categories, with each ECG beat decomposed into multiple features and</claim-text><claim-text>defining membership functions for each beat category for each feature;</claim-text></claim-text><claim-text>b. performing an operating phase, wherein
<claim-text>(i) for each ECG beat to be classified, decompose the ECG beat into the multiple features;</claim-text><claim-text>(ii) compute values of each membership function identified in the step of performing the training phase for each feature of the ECG beat for the different categories;</claim-text><claim-text>(iii) merge the membership function values for all features in an ECG beat in a manner as to get a single beat value for each beat category across the features;</claim-text><claim-text>(iv) identify a value alpha in the range [0,1], such that the difference between the top two beat values across the different beat categories is more than or equal to the sum of the beat values of all the remaining beat categories multiplied by the value alpha and such that a desired percentage of normal or abnormal beat classification is obtained;</claim-text><claim-text>(v) if an alpha value can be identified, then classify the beat to belong to the beat that has the highest beat value, otherwise classify the beat as abnormal.</claim-text></claim-text></claim-text>
    </claim>
    <claim num="2" id="clm-00002-en">
      <claim-text>
        <b>2</b>. The method of <claim-ref idref="clm-00001-en">claim 1</claim-ref>, wherein the ECG beat is decomposed into multiple features, and the feature set vector is reduced by multiplying the vector by a matrix such that the output is a vector with fewer entries.</claim-text>
    </claim>
    <claim num="3" id="clm-00003-en">
      <claim-text>
        <b>3</b>. The method of <claim-ref idref="clm-00002-en">claim 2</claim-ref>, wherein the matrix is composed such that the entries are randomly assigned a value of {+1, −1, 0} with a pre-defined probability values of {⅙, ⅙, ⅔}.</claim-text>
    </claim>
    <claim num="4" id="clm-00004-en">
      <claim-text>
        <b>4</b>. The method of <claim-ref idref="clm-00002-en">claim 2</claim-ref>, further comprising
<claim-text>generating multiple matrices by starting from a set of initial random matrices and using a genetic algorithm;</claim-text><claim-text>using the newly reduced features in the step of performing the operating phase; and</claim-text><claim-text>choosing from the generated multiple matrices the matrix that has the best performance in achieving the desired percentage of classification of normal and abnormal beats for the step of performing the operating phase.</claim-text></claim-text>
    </claim>
    <claim num="5" id="clm-00005-en">
      <claim-text>
        <b>5</b>. The method of <claim-ref idref="clm-00001-en">claim 1</claim-ref>, wherein the step of performing the operating phase is run on an embedded micro-controller, such that the floating point operations involved are converted into integer operations.</claim-text>
    </claim>
    <claim num="6" id="clm-00006-en">
      <claim-text>
        <b>6</b>. The method of <claim-ref idref="clm-00001-en">claim 1</claim-ref>, wherein each of the membership functions is a Guassian function.</claim-text>
    </claim>
    <claim num="7" id="clm-00007-en">
      <claim-text>
        <b>7</b>. The method of <claim-ref idref="clm-00006-en">claim 6</claim-ref>, wherein the step of performing the operating phase is run on an embedded micro-controller, such that the result of the step of merging the membership function values for all features in an ECG beat involves an approximation by a combination of linear functions.</claim-text>
    </claim>
    <claim num="8" id="clm-00008-en">
      <claim-text>
        <b>8</b>. The method of <claim-ref idref="clm-00007-en">claim 7</claim-ref>, wherein exactly four linear functions are used to fit the Gaussian function.</claim-text>
    </claim>
    <claim num="9" id="clm-00009-en">
      <claim-text>
        <b>9</b>. The method of <claim-ref idref="clm-00001-en">claim 1</claim-ref>, wherein the step of merging the membership function values is performed by multiplying the membership values together.</claim-text>
    </claim>
    <claim num="10" id="clm-00010-en">
      <claim-text>
        <b>10</b>. The method of <claim-ref idref="clm-00005-en">claim 5</claim-ref>, wherein
<claim-text>the step of merging the membership function values is performed by multiplying the membership values together, and</claim-text><claim-text>the membership function values are scaled uniformly by a constant value, in order to avoid the multiplied values to reach 0 when converted into integer values when used on an embedded processor.</claim-text></claim-text>
    </claim>
    <claim num="11" id="clm-00011-en">
      <claim-text>
        <b>11</b>. The method of <claim-ref idref="clm-00008-en">claim 8</claim-ref>, wherein
<claim-text>the step of merging the membership function values is performed by multiplying the membership values together, and</claim-text><claim-text>the membership function values are scaled uniformly by a constant value, in order to avoid the multiplied values to reach 0 when converted into integer values when used on an embedded processor.</claim-text></claim-text>
    </claim>
    <claim num="12" id="clm-00012-en">
      <claim-text>
        <b>12</b>. The method of <claim-ref idref="clm-00010-en">claim 10</claim-ref>, wherein the scaling by a constant value is achieved by left shifting the binary equivalent of the values across all the membership functions by a constant amount.</claim-text>
    </claim>
    <claim num="13" id="clm-00013-en">
      <claim-text>
        <b>13</b>. The method of <claim-ref idref="clm-00011-en">claim 11</claim-ref>, wherein the scaling by a constant value is achieved by left shifting the binary equivalent of the values across all the membership functions by a constant amount.</claim-text>
    </claim>
    <claim num="14" id="clm-00014-en">
      <claim-text>
        <b>14</b>. The method of <claim-ref idref="clm-00001-en">claim 1</claim-ref>, wherein additional values of fiducial points of an ECG are added to decomposed features.</claim-text>
    </claim>
    <claim num="15" id="clm-00015-en">
      <claim-text>
        <b>15</b>. The method of <claim-ref idref="clm-00014-en">claim 14</claim-ref>, wherein the fiducial points comprise a starting point, a peak or end of P wave, a QRS complex, a R-peak and a T wave of the ECG.</claim-text>
    </claim>
    <claim num="16" id="clm-00016-en">
      <claim-text>
        <b>16</b>. The method of <claim-ref idref="clm-00014-en">claim 14</claim-ref>, wherein distances between the fiducial points are added to a sample space.</claim-text>
    </claim>
    <claim num="17" id="clm-00017-en" independent="true">
      <claim-text>
        <b>17</b>. A Wireless Body Sensor Nodes device that comprises a code in its memory, that when executed by a processor of the device causes the device to execute a method for classification of ECG beats into normal and different categories of abnormal beats, the method comprising the following steps,
<claim-text>a. performing a training phase comprising
<claim-text>taking as an input one or more ECG beats that are pre-classified into the different categories, with each ECG beat decomposed into multiple features</claim-text><claim-text>defining membership functions for each beat category for each feature;</claim-text></claim-text><claim-text>b. performing an operating phase, wherein
<claim-text>(i) for each ECG beat to be classified, decompose the ECG beat into the multiple features;</claim-text><claim-text>(ii) compute values of each membership function identified in the step of performing the training phase for each feature of the ECG beat for the different categories;</claim-text><claim-text>(iii) merge the membership function values for all features in an ECG beat in a manner as to get a single beat value for each beat category across the features;</claim-text><claim-text>(iv) identify a value alpha in the range [0,1], such that the difference between the top two beat values across the different beat categories is more than or equal to the sum of the beat values of all the remaining beat categories multiplied by the value alpha and such that a desired percentage of normal or abnormal beat classification is obtained;</claim-text><claim-text>(v) if an alpha value can be identified, then classify the beat to belong to the beat that has the highest beat value, otherwise classify the beat as abnormal.</claim-text></claim-text></claim-text>
    </claim>
    <claim num="18" id="clm-00018-en">
      <claim-text>
        <b>18</b>. The method of <claim-ref idref="clm-00003-en">claim 3</claim-ref>, further comprising
<claim-text>generating multiple matrices by starting from a set of initial random matrices and using a genetic algorithm;</claim-text><claim-text>using the newly reduced features in the step of performing the operating phase; and</claim-text><claim-text>choosing from the generated multiple matrices the matrix that has the best performance in achieving the desired percentage of classification of normal and abnormal beats for the step of performing the operating phase.</claim-text></claim-text>
    </claim>
    <claim num="19" id="clm-00019-en">
      <claim-text>
        <b>19</b>. The method of <claim-ref idref="clm-00015-en">claim 15</claim-ref>, wherein distances between the fiducial points are added to a sample space. </claim-text>
    </claim>
  </claims>
  <drawings id="drawings" format="original">
    <figure num="1">
      <img he="N/A" wi="N/A" file="US20150257668A1_00001.PNG" alt="clipped image" img-content="drawing" img-format="png" original="US20150257668A1-20150917-D00000.TIF" />
    </figure>
    <figure num="2">
      <img he="N/A" wi="N/A" file="US20150257668A1_00002.PNG" alt="drawing sheet" img-content="drawing" img-format="png" original="US20150257668A1-20150917-D00001.TIF" />
    </figure>
    <figure num="3">
      <img he="N/A" wi="N/A" file="US20150257668A1_00003.PNG" alt="drawing sheet" img-content="drawing" img-format="png" original="US20150257668A1-20150917-D00002.TIF" />
    </figure>
    <figure num="4">
      <img he="N/A" wi="N/A" file="US20150257668A1_00004.PNG" alt="drawing sheet" img-content="drawing" img-format="png" original="US20150257668A1-20150917-D00003.TIF" />
    </figure>
    <figure num="5">
      <img he="N/A" wi="N/A" file="US20150257668A1_00005.PNG" alt="drawing sheet" img-content="drawing" img-format="png" original="US20150257668A1-20150917-D00004.TIF" />
    </figure>
    <figure num="6">
      <img he="N/A" wi="N/A" file="US20150257668A1_00006.PNG" alt="mathematical image" img-content="math" img-format="png" original="US20150257668A1-20150917-M00001.TIF" inline="yes" />
    </figure>
    <figure num="7">
      <img he="N/A" wi="N/A" file="US20150257668A1_00007.PNG" alt="mathematical image" img-content="math" img-format="png" original="US20150257668A1-20150917-M00002.TIF" inline="yes" />
    </figure>
    <figure num="8">
      <img he="N/A" wi="N/A" file="US20150257668A1_00008.PNG" alt="mathematical image" img-content="math" img-format="png" original="US20150257668A1-20150917-M00003.TIF" inline="yes" />
    </figure>
    <figure num="9">
      <img he="N/A" wi="N/A" file="US20150257668A1_00009.PNG" alt="thumbnail image" img-content="drawing" img-format="png" original="US20150257668A1-20150917-D00000.TIF" />
    </figure>
  </drawings>
  <image file="US20150257668A1.PDF" type="pdf" size="637893" pages="11" />
</lexisnexis-patent-document>